# Запрет FIN-сканирования
iptables -A INPUT –p tcp –m tcp –-tcp-flags FIN,ACK FIN -j DROP

# Запрет X-сканирования
iptables -A INPUT –p tcp –m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG
FIN,SYN,RST,PSH,ACK,URG –j DROP

# Запрет N-сканирования
Linux> iptables -A INPUT –p tcp –m tcp –-tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE –j DROP


# Проверка на стук в нерабочие порты (10 в час)
iptables -A INPUT -m recent --rcheck --seconds 3600 --hitcount 10 --rttl -j RETURN
# Вторая проверка на стук в нерабочие порты (2 в минуту)
iptables -A INPUT -m recent --rcheck --seconds 60 --hitcount 2 --rttl -j RETURN
# Заносим адреса стучащихся в список
iptables -A INPUT -m recent --set
# Отбрасываем пакеты всех, кто превысил лимит на количество подключений
iptables -P INPUT -j DROP

iptables -I INPUT -p tcp -m osf --genre NMAP -j DROP
